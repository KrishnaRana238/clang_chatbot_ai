<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clang Chatbot Testing Interface</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            height: calc(100vh - 40px);
        }
        
        .test-panel {
            background: white;
            border-radius: 10px;
            padding: 20px;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .chatbot-frame {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .chatbot-frame iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        h1 {
            color: #333;
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        h2 {
            color: #555;
            margin: 20px 0 10px 0;
            font-size: 18px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }
        
        .test-scenario {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            transition: all 0.3s ease;
        }
        
        .test-scenario:hover {
            background: #e3f2fd;
            border-color: #667eea;
        }
        
        .scenario-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }
        
        .scenario-input {
            font-family: 'Monaco', 'Menlo', monospace;
            background: #2d3748;
            color: #e2e8f0;
            padding: 8px 12px;
            border-radius: 4px;
            margin: 5px 0;
            font-size: 14px;
        }
        
        .scenario-expected {
            color: #4a5568;
            font-style: italic;
            margin-top: 5px;
        }
        
        .test-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            margin: 5px;
            transition: transform 0.2s ease;
        }
        
        .test-btn:hover {
            transform: translateY(-2px);
        }
        
        .test-btn:active {
            transform: translateY(0);
        }
        
        .run-all-btn {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            font-size: 16px;
            padding: 15px 30px;
            margin: 20px 0;
            width: 100%;
        }
        
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .status.pending {
            background: #fed7d7;
            color: #c53030;
        }
        
        .status.running {
            background: #feebc8;
            color: #dd6b20;
        }
        
        .status.success {
            background: #c6f6d5;
            color: #25855a;
        }
        
        .status.failed {
            background: #fed7d7;
            color: #c53030;
        }
        
        .performance-metrics {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }
        
        .metric-value {
            font-weight: 600;
            color: #667eea;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="test-panel">
            <h1>üß™ Clang Chatbot Testing Suite</h1>
            
            <div class="performance-metrics">
                <h3>üìä Performance Metrics</h3>
                <div class="metric">
                    <span>Tests Completed:</span>
                    <span class="metric-value" id="testsCompleted">0/30</span>
                </div>
                <div class="metric">
                    <span>Success Rate:</span>
                    <span class="metric-value" id="successRate">0%</span>
                </div>
                <div class="metric">
                    <span>Avg Response Time:</span>
                    <span class="metric-value" id="avgResponseTime">0ms</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            
            <button class="test-btn run-all-btn" onclick="runAllTests()">
                üöÄ Run All Test Scenarios
            </button>
            
            <h2>üó£Ô∏è Basic Conversation Tests</h2>
            <div class="test-scenario" data-category="basic">
                <div class="scenario-title">Greeting & Introduction</div>
                <div class="scenario-input">User: "Hello, what's your name?"</div>
                <div class="scenario-expected">Expected: Introduction with capabilities</div>
                <button class="test-btn" onclick="runTest('Hello, what\\'s your name?', 'basic', 1)">Test</button>
                <span class="status pending" id="status-basic-1">Pending</span>
            </div>
            
            <div class="test-scenario" data-category="basic">
                <div class="scenario-title">Capability Inquiry</div>
                <div class="scenario-input">User: "What can you help me with?"</div>
                <div class="scenario-expected">Expected: Comprehensive capability list</div>
                <button class="test-btn" onclick="runTest('What can you help me with?', 'basic', 2)">Test</button>
                <span class="status pending" id="status-basic-2">Pending</span>
            </div>
            
            <div class="test-scenario" data-category="basic">
                <div class="scenario-title">Memory Test</div>
                <div class="scenario-input">User: "Remember that my name is Krishna"</div>
                <div class="scenario-expected">Expected: Acknowledgment and memory storage</div>
                <button class="test-btn" onclick="runTest('Remember that my name is Krishna', 'basic', 3)">Test</button>
                <span class="status pending" id="status-basic-3">Pending</span>
            </div>
            
            <h2>üè• Medical Knowledge Tests</h2>
            <div class="test-scenario" data-category="medical">
                <div class="scenario-title">Symptom Analysis</div>
                <div class="scenario-input">User: "I have a headache and fever, what could it be?"</div>
                <div class="scenario-expected">Expected: Possible causes with medical disclaimer</div>
                <button class="test-btn" onclick="runTest('I have a headache and fever, what could it be?', 'medical', 1)">Test</button>
                <span class="status pending" id="status-medical-1">Pending</span>
            </div>
            
            <div class="test-scenario" data-category="medical">
                <div class="scenario-title">Medication Inquiry</div>
                <div class="scenario-input">User: "What is the dosage for ibuprofen?"</div>
                <div class="scenario-expected">Expected: General dosage info with professional advice</div>
                <button class="test-btn" onclick="runTest('What is the dosage for ibuprofen?', 'medical', 2)">Test</button>
                <span class="status pending" id="status-medical-2">Pending</span>
            </div>
            
            <div class="test-scenario" data-category="medical">
                <div class="scenario-title">Emergency Situation</div>
                <div class="scenario-input">User: "I'm having chest pain"</div>
                <div class="scenario-expected">Expected: Emergency advice to seek immediate medical attention</div>
                <button class="test-btn" onclick="runTest('I\\'m having chest pain', 'medical', 3)">Test</button>
                <span class="status pending" id="status-medical-3">Pending</span>
            </div>
            
            <h2>üî¢ Mathematical Capabilities</h2>
            <div class="test-scenario" data-category="math">
                <div class="scenario-title">Basic Arithmetic</div>
                <div class="scenario-input">User: "Calculate 15 * 23 + 45"</div>
                <div class="scenario-expected">Expected: 390</div>
                <button class="test-btn" onclick="runTest('Calculate 15 * 23 + 45', 'math', 1)">Test</button>
                <span class="status pending" id="status-math-1">Pending</span>
            </div>
            
            <div class="test-scenario" data-category="math">
                <div class="scenario-title">Quadratic Equation</div>
                <div class="scenario-input">User: "Solve: x^2 + 5x + 6 = 0"</div>
                <div class="scenario-expected">Expected: x = -2 or x = -3</div>
                <button class="test-btn" onclick="runTest('Solve: x^2 + 5x + 6 = 0', 'math', 2)">Test</button>
                <span class="status pending" id="status-math-2">Pending</span>
            </div>
            
            <div class="test-scenario" data-category="math">
                <div class="scenario-title">Calculus</div>
                <div class="scenario-input">User: "What's the derivative of x^3 + 2x^2?"</div>
                <div class="scenario-expected">Expected: 3x^2 + 4x</div>
                <button class="test-btn" onclick="runTest('What\\'s the derivative of x^3 + 2x^2?', 'math', 3)">Test</button>
                <span class="status pending" id="status-math-3">Pending</span>
            </div>
            
            <h2>üíª Programming Assistance</h2>
            <div class="test-scenario" data-category="programming">
                <div class="scenario-title">Algorithm Explanation</div>
                <div class="scenario-input">User: "Explain bubble sort algorithm"</div>
                <div class="scenario-expected">Expected: Clear explanation with example</div>
                <button class="test-btn" onclick="runTest('Explain bubble sort algorithm', 'programming', 1)">Test</button>
                <span class="status pending" id="status-programming-1">Pending</span>
            </div>
            
            <div class="test-scenario" data-category="programming">
                <div class="scenario-title">Code Debugging</div>
                <div class="scenario-input">User: "Debug this Python code: for i in range(10) print(i)"</div>
                <div class="scenario-expected">Expected: Syntax error identification (missing colon)</div>
                <button class="test-btn" onclick="runTest('Debug this Python code: for i in range(10) print(i)', 'programming', 2)">Test</button>
                <span class="status pending" id="status-programming-2">Pending</span>
            </div>
            
            <h2>‚ö° Performance Tests</h2>
            <div class="test-scenario" data-category="performance">
                <div class="scenario-title">Rapid Messages</div>
                <div class="scenario-input">System: Send 10 rapid messages</div>
                <div class="scenario-expected">Expected: Smooth handling without lag</div>
                <button class="test-btn" onclick="runPerformanceTest()">Test</button>
                <span class="status pending" id="status-performance-1">Pending</span>
            </div>
        </div>
        
        <div class="chatbot-frame">
            <iframe src="http://127.0.0.1:8000" id="chatbotFrame"></iframe>
        </div>
    </div>

    <script>
        let testResults = {};
        let totalTests = 12;
        let completedTests = 0;
        let successfulTests = 0;
        let responseTimes = [];

        function updateMetrics() {
            document.getElementById('testsCompleted').textContent = `${completedTests}/${totalTests}`;
            document.getElementById('successRate').textContent = `${Math.round((successfulTests / Math.max(completedTests, 1)) * 100)}%`;
            
            const avgTime = responseTimes.length > 0 ? 
                Math.round(responseTimes.reduce((a, b) => a + b, 0) / responseTimes.length) : 0;
            document.getElementById('avgResponseTime').textContent = `${avgTime}ms`;
            
            const progress = (completedTests / totalTests) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        async function runTest(message, category, testId) {
            const statusElement = document.getElementById(`status-${category}-${testId}`);
            statusElement.textContent = 'Running';
            statusElement.className = 'status running';
            
            const startTime = Date.now();
            
            try {
                // Send message to chatbot frame
                const chatbotFrame = document.getElementById('chatbotFrame');
                const chatbotWindow = chatbotFrame.contentWindow;
                
                // Post message to chatbot
                chatbotWindow.postMessage({
                    type: 'sendMessage',
                    message: message
                }, '*');
                
                // Wait for response (simulate)
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                const responseTime = Date.now() - startTime;
                responseTimes.push(responseTime);
                
                // Mark as success (in real implementation, you'd validate the response)
                statusElement.textContent = 'Success';
                statusElement.className = 'status success';
                successfulTests++;
                
                testResults[`${category}-${testId}`] = {
                    message,
                    responseTime,
                    success: true
                };
                
            } catch (error) {
                statusElement.textContent = 'Failed';
                statusElement.className = 'status failed';
                
                testResults[`${category}-${testId}`] = {
                    message,
                    success: false,
                    error: error.message
                };
            }
            
            completedTests++;
            updateMetrics();
        }

        async function runPerformanceTest() {
            const statusElement = document.getElementById('status-performance-1');
            statusElement.textContent = 'Running';
            statusElement.className = 'status running';
            
            try {
                const chatbotFrame = document.getElementById('chatbotFrame');
                const chatbotWindow = chatbotFrame.contentWindow;
                
                // Send 10 rapid messages
                const messages = [
                    "Test message 1",
                    "Test message 2", 
                    "Test message 3",
                    "Test message 4",
                    "Test message 5",
                    "Test message 6",
                    "Test message 7",
                    "Test message 8",
                    "Test message 9",
                    "Test message 10"
                ];
                
                const startTime = Date.now();
                
                for (let i = 0; i < messages.length; i++) {
                    chatbotWindow.postMessage({
                        type: 'sendMessage',
                        message: messages[i]
                    }, '*');
                    await new Promise(resolve => setTimeout(resolve, 100)); // Small delay between messages
                }
                
                const totalTime = Date.now() - startTime;
                
                statusElement.textContent = `Success (${totalTime}ms)`;
                statusElement.className = 'status success';
                successfulTests++;
                
            } catch (error) {
                statusElement.textContent = 'Failed';
                statusElement.className = 'status failed';
            }
            
            completedTests++;
            updateMetrics();
        }

        async function runAllTests() {
            // Reset metrics
            completedTests = 0;
            successfulTests = 0;
            responseTimes = [];
            testResults = {};
            
            // Reset all status indicators
            document.querySelectorAll('.status').forEach(status => {
                status.textContent = 'Pending';
                status.className = 'status pending';
            });
            
            updateMetrics();
            
            // Run all tests with delays
            const tests = [
                () => runTest("Hello, what's your name?", 'basic', 1),
                () => runTest('What can you help me with?', 'basic', 2),
                () => runTest('Remember that my name is Krishna', 'basic', 3),
                () => runTest('I have a headache and fever, what could it be?', 'medical', 1),
                () => runTest('What is the dosage for ibuprofen?', 'medical', 2),
                () => runTest("I'm having chest pain", 'medical', 3),
                () => runTest('Calculate 15 * 23 + 45', 'math', 1),
                () => runTest('Solve: x^2 + 5x + 6 = 0', 'math', 2),
                () => runTest("What's the derivative of x^3 + 2x^2?", 'math', 3),
                () => runTest('Explain bubble sort algorithm', 'programming', 1),
                () => runTest('Debug this Python code: for i in range(10) print(i)', 'programming', 2),
                () => runPerformanceTest()
            ];
            
            for (let i = 0; i < tests.length; i++) {
                await tests[i]();
                await new Promise(resolve => setTimeout(resolve, 1000)); // Wait between tests
            }
            
            // Show final results
            setTimeout(() => {
                alert(`Testing Complete!\\n\\nResults:\\n- Tests Completed: ${completedTests}/${totalTests}\\n- Success Rate: ${Math.round((successfulTests / completedTests) * 100)}%\\n- Average Response Time: ${Math.round(responseTimes.reduce((a, b) => a + b, 0) / responseTimes.length)}ms`);
            }, 1000);
        }

        // Listen for messages from chatbot iframe
        window.addEventListener('message', function(event) {
            if (event.data.type === 'chatbotResponse') {
                console.log('Received response from chatbot:', event.data);
            }
        });

        // Initialize metrics
        updateMetrics();
    </script>
</body>
</html>
